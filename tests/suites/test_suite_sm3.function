/* BEGIN_HEADER */
#include "mbedtls/sm3.h"
/* END_HEADER */

/* BEGIN_CASE depends_on:MBEDTLS_SM3_C */
void mbedtls_sm3( data_t * src_str, data_t * hash )
{
    unsigned char output[65];

    memset(output, 0x00, 65);


    TEST_ASSERT( mbedtls_sm3_ret( src_str->x, src_str->len, output ) == 0 );

    TEST_ASSERT( mbedtls_test_hexcmp( output, hash->x, 32, hash->len ) == 0 );
}
/* END_CASE */

/* BEGIN_CASE depends_on:MBEDTLS_SM3_C:MBEDTLS_SELF_TEST */
void sm3_selftest(  )
{
    TEST_ASSERT( mbedtls_sm3_self_test( 1 ) == 0 );
}
/* END_CASE */
