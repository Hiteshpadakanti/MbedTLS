/* BEGIN_HEADER */
#include <test/ssl_helpers.h>

/* END_HEADER */

/* BEGIN_DEPENDENCIES
 * depends_on:MBEDTLS_SSL_TLS_C
 * END_DEPENDENCIES
 */

/* BEGIN_CASE */
void handshake_ssl_connection( int dtls, int expected_negotiated_version,
                               char* cipher, int pk_alg,
                               int expected_ciphersuite  )
{
    mbedtls_test_handshake_test_options options;
    mbedtls_test_init_handshake_options( &options );

    options.dtls = dtls;
    options.expected_negotiated_version = expected_negotiated_version;
    options.cipher = cipher;
    options.pk_alg = pk_alg;
    options.expected_ciphersuite = expected_ciphersuite;

    mbedtls_test_ssl_perform_handshake( &options );

    /* The goto below is used to avoid an "unused label" warning.*/
    goto exit;

exit:
    mbedtls_test_free_handshake_options( &options );
}
/* END_CASE */
